# Interactive HTML BOM plugin for KiCad
## Supports KiCad and Altium Designer PCB files

![icon](https://i.imgur.com/js4kDOn.png)

## About This Project

This project combines two excellent open-source tools to provide a unified solution for generating interactive HTML BOMs from both KiCad and Altium Designer PCB files:

- **[InteractiveHtmlBom](https://github.com/openscopeproject/InteractiveHtmlBom)** - The core BOM generation engine that creates beautiful, interactive HTML Bill of Materials from KiCad PCB files
- **[altium2kicad](https://github.com/thesourcerer8/altium2kicad)** - A Perl-based converter that transforms Altium Designer `.PcbDoc` files into KiCad `.kicad_pcb` format

This integration adds:
- **Web-based interface** for easy file upload and BOM generation
- **Automatic Altium support** by converting `.PcbDoc` files to KiCad format before processing
- **Unified workflow** - one tool for both KiCad and Altium Designer files

## Credits

This project is built upon and extends the following open-source projects:

### InteractiveHtmlBom
- **Repository:** https://github.com/openscopeproject/InteractiveHtmlBom
- **License:** MIT
- **Original Work:** OpenScope Project
- Provides the core BOM generation functionality, HTML rendering, and interactive features

### altium2kicad
- **Repository:** https://github.com/thesourcerer8/altium2kicad
- **License:** See `altium2kicad/LICENSE` file
- **Original Work:** thesourcerer8
- Provides Altium Designer to KiCad PCB conversion functionality

Both projects are included in this repository (with proper attribution) to provide a complete, ready-to-use solution.

---

This plugin generates a convenient Bill of Materials (BOM) listing with the
ability to visually correlate and easily search for components and their placements
on the PCB. It is particularly useful when hand-soldering a prototype, as it allows
users to quickly find locations of components groups on the board. It is also possible
to reverse lookup the component group by clicking on a footprint on the board drawing.

The plugin utilizes Pcbnew python API to read PCB data and render silkscreen, fab layer,
footprint pads, text, and drawings. BOM table fields and grouping is fully configurable,
additional columns, such as a manufacturer ID, can be added in Schematic editor and
imported either through the netlist file, XML file generated by Eeschema's internal
BOM tool, or from board file itself.

There is an option to include tracks/zones data as well as netlist information allowing
dynamic highlight of nets on the board.

For full description of functionality see [wiki](https://github.com/openscopeproject/InteractiveHtmlBom/wiki).

Generated html page is fully self contained, doesn't need internet connection to work
and can be packaged with documentation of your project or hosted anywhere on the web.

[A demo is worth a thousand words.](https://openscopeproject.org/InteractiveHtmlBomDemo/)

## Installation and Usage

### Requirements

1. **KiCad** - Required for parsing PCB files
   - Install from: https://www.kicad.org/download/
   - The Python API (pcbnew) is bundled with KiCad

2. **Perl** - Required for Altium file conversion
   - Check: `perl --version`
   - Usually pre-installed on macOS/Linux
   - Windows: Install from https://www.perl.org/get.html

3. **Python dependencies**
   - wxPython >= 4.0
   - Install with: `pip install wxpython`

### Supported Formats

- **KiCad** - `.kicad_pcb` files (native support)
- **Altium Designer** - `.PcbDoc` files (converted to KiCad format automatically)

### Usage

#### Web Interface (Recommended)

**To start the web interface:**

Simply run:
```bash
python3 run.py
```

Or on macOS/Linux, you can make it executable and run directly:
```bash
chmod +x run.py
./run.py
```

The launcher will automatically:
- Detect and use KiCad's Python (required for pcbnew module)
- Start the web server
- Open your browser to the upload interface

**Note:** If you run `web/web_server.py` directly with system Python, it will automatically restart with KiCad Python if detected, or show an error message.

This will:
- Start a local web server
- Open your browser automatically
- Provide a drag-and-drop interface to upload `.PcbDoc` or `.kicad_pcb` files
- Generate the BOM and open it in a new tab
- Store files in a temporary directory (configurable)

**Features:**
- Simple drag-and-drop file upload
- Optional custom temporary directory
- Automatic cleanup of temporary files
- Opens generated BOM in new browser tab

#### Command Line Interface

**For KiCad Files:**

```bash
python3 InteractiveHtmlBom/generate_interactive_bom.py board.kicad_pcb
```

**For Altium Files:**

```bash
python3 InteractiveHtmlBom/generate_interactive_bom.py board.PcbDoc
```

The Altium parser will:
1. Automatically find the included `altium2kicad` converter in the repository
2. Convert the `.PcbDoc` to `.kicad_pcb` format (cached for future use)
3. Use the KiCad parser to generate the HTML BOM

**Note:** On some systems, you may need to use KiCad's bundled Python:

**macOS:**
```bash
/Applications/KiCad/KiCad.app/Contents/Frameworks/Python.framework/Versions/Current/bin/python3 \
  InteractiveHtmlBom/generate_interactive_bom.py board.PcbDoc
```

**Linux:**
```bash
# KiCad Python is typically available as:
python3 InteractiveHtmlBom/generate_interactive_bom.py board.PcbDoc
# Or if KiCad is installed via package manager:
kicad-python3 InteractiveHtmlBom/generate_interactive_bom.py board.PcbDoc
```

**Windows:**
```bash
# Use KiCad's Python from the installation directory
"C:\Program Files\KiCad\bin\python.exe" InteractiveHtmlBom\generate_interactive_bom.py board.PcbDoc
```

### How Altium Conversion Works

1. The `AltiumParser` detects `.PcbDoc` files
2. It searches for the `altium2kicad` converter (included in repository)
3. Converts the `.PcbDoc` to `.kicad_pcb` format (cached for future use)
4. Uses the existing KiCad parser to generate the HTML BOM

### Troubleshooting

**"altium2kicad converter not found"**
- The converter should be included in the `altium2kicad` directory in the repository root
- If missing, ensure you cloned the repository completely
- The converter will also be searched in common installation locations

**"Perl is required but not found"**
- Install Perl: `brew install perl` (macOS), or use your system package manager
- Windows: Download from https://www.perl.org/get.html

**"KiCad Python API (pcbnew) is required"**
- Ensure KiCad is installed
- Use KiCad's bundled Python (see Usage section above)
- Or ensure pcbnew module is available in your Python environment

**Conversion errors**
- Check that the `.PcbDoc` file is not corrupted
- Verify altium2kicad converter scripts are executable: `chmod +x altium2kicad/*.pl`
- Check converter logs for specific error messages

### Notes

- The converted `.kicad_pcb` file is saved in the same directory as the original `.PcbDoc`
- If the converted file exists and is newer than the original, it will be reused
- Temporary files are automatically cleaned up after conversion

## License and Credits

### This Project
The web interface and integration code in this repository is licensed under MIT license, see `LICENSE` for more info.

### Original Projects
- **InteractiveHtmlBom** - MIT License (see original project)
- **altium2kicad** - See `altium2kicad/LICENSE` file for license details

### Additional Libraries
The generated HTML page uses:
- [Split.js](https://github.com/nathancahill/Split.js) - MIT License
- [PEP.js](https://github.com/jquery/PEP) - MIT License  
- [lz-string.js](https://github.com/pieroxy/lz-string) - WTFPL License (stripped down version embedded)

### Other Components
- `units.py` is borrowed from [KiBom](https://github.com/SchrodingersGat/KiBoM) plugin (MIT license)
- `svgpath.py` is heavily based on [svgpathtools](https://github.com/mathandy/svgpathtools) module (MIT license)
